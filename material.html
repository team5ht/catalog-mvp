<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Материал</title>
<link rel="stylesheet" href="style.css" />
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#f8fafc">
</head>
<body>
<main class="material-page">
  <!-- Кнопка назад -->
  <button class="back-btn" onclick="history.back()" aria-label="Назад">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <!-- Обложка материала -->
  <div class="material-cover-wrapper">
    <div id="materialCover" class="material-cover"></div>
  </div>

  <!-- Кнопка действия -->
  <button id="downloadBtn" class="btn-download">Скачать</button>

  <!-- Контент -->
  <div class="material-content">
    <h1 id="materialTitle" class="material-title">Загрузка...</h1>
    
    <section class="material-section">
      <h2>О материале</h2>
      <p id="materialDescription" class="material-description"></p>
    </section>

    <section class="material-section">
      <h2>Теги</h2>
      <div id="materialTags" class="material-tags"></div>
    </section>
  </div>
</main>

<nav class="bottom-nav">
  <button id="nav-home" class="nav-btn" aria-label="Главная">
    <svg width="24" height="24"><path d="M3 12l9-9 9 9v9a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-9z" fill="none" stroke="#64748b" stroke-width="2"/></svg>
  </button>
  <button id="nav-catalog" class="nav-btn" aria-label="Каталог">
    <svg width="24" height="24"><rect x="3" y="4" width="18" height="16" fill="none" stroke="#64748b" stroke-width="2"/></svg>
  </button>
  <button id="nav-login" class="nav-btn" aria-label="Профиль">
    <svg width="24" height="24"><circle cx="12" cy="8" r="4" fill="none" stroke="#64748b" stroke-width="2"/><path d="M4 20c0-4 16-4 16 0" fill="none" stroke="#64748b" stroke-width="2"/></svg>
  </button>
</nav>

<script src="app.js"></script>
<script>
document.getElementById('nav-home').onclick = () => location.href = 'index.html';
document.getElementById('nav-catalog').onclick = () => location.href = 'catalog.html';
document.getElementById('nav-login').onclick = () => location.href = 'login.html';

// Получаем ID материала из URL
const urlParams = new URLSearchParams(window.location.search);
const materialId = parseInt(urlParams.get('id'));

if (!materialId) {
  location.href = 'index.html';
}

// Загружаем данные и отображаем материал
fetch('data.json')
  .then(r => r.json())
  .then(data => {
    const material = data.materials.find(m => m.id === materialId);
    if (!material) {
      location.href = 'index.html';
      return;
    }

    // Обложка
    document.getElementById('materialCover').style.backgroundImage = `url(${material.cover})`;
    
    // Название
    document.getElementById('materialTitle').textContent = material.title;
    
    // Описание
    document.getElementById('materialDescription').textContent = material.description;
    
    // Теги
    const tagsContainer = document.getElementById('materialTags');
    if (material.tags && material.tags.length > 0) {
      material.tags.forEach(tag => {
        const tagEl = document.createElement('span');
        tagEl.className = 'tag';
        tagEl.textContent = tag;
        tagsContainer.appendChild(tagEl);
      });
    } else {
      tagsContainer.innerHTML = '<span class="tag">Без тегов</span>';
    }

    // Кнопка скачать
    document.getElementById('downloadBtn').onclick = () => {
      if (material.pdfUrl) {
        window.open(material.pdfUrl, '_blank');
      } else {
        alert('Ссылка на материал недоступна');
      }
    };
  });
</script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('sw.js');
  });
}
</script>
</body>
</html>
